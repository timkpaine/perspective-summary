import"regular-table";var X='regular-table{padding:0;margin:12px 0 0 12px;scrollbar-color:transparent transparent;scrollbar-width:thin;outline:none;}regular-table:hover{scrollbar-color:rgba(0,0,0,0.3)transparent;}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table tbody td,perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table thead th:not(.rt-group-corner){transform:translate(var(--regular-table--transform-x,0px));}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table tbody{transform:translate(0,var(--regular-table--transform-y,0px));}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table tbody tr:first-child td,perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table tbody tr:first-child th{clip-path:polygon(0 var(--regular-table--clip-y,0),0 200%,200% 200%,200% var(--regular-table--clip-y,0));}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table thead th.rt-group-corner{background:var(--plugin--background,white);z-index:1;}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table tbody tr td:first-of-type{clip-path:polygon(var(--regular-table--clip-x,0)0,var(--regular-table--clip-x,0)200%,200% 200%,200% 0);}perspective-viewer-datagrid:not(.sub-cell-scroll-disabled) regular-table table tbody tr:first-child td:first-of-type{clip-path:polygon(var(--regular-table--clip-x,0)var(--regular-table--clip-y,0),var(--regular-table--clip-x,0)200%,200% 200%,200% var(--regular-table--clip-y,0));}regular-table{font-family:inherit;}regular-table div[tabindex]{outline:none;}regular-table>div{position:absolute;top:0;left:0;right:0;bottom:0;overflow:hidden;}regular-table th{text-align:center;}regular-table thead tr:not(:last-child) th{overflow:hidden;max-width:0px;}regular-table thead tr:last-child .rt-float,regular-table tbody .rt-float{text-align:right;}regular-table thead .rt-integer,regular-table tbody .rt-integer{text-align:right;}regular-table tbody th{text-align:left;}regular-table span.rt-tree-container{display:flex;align-items:center;height:100%;}regular-table thead .rt-string,regular-table tbody .rt-string,regular-table thead .rt-date,regular-table tbody .rt-date,regular-table thead .rt-datetime,regular-table tbody .rt-datetime{text-align:left;}regular-table thead tr:last-child th{border-bottom:1px solid#8b868045;}regular-table tbody tr:first-child td,regular-table tbody tr:first-child th{border-top:1px solid transparent!important;}regular-table th{position:relative;}regular-table tr th span.rt-tree-group{margin-left:5px;margin-right:15px;border-left:1px solid#eee;height:100%;}regular-table td,regular-table th{white-space:nowrap;font-size:12px;padding-right:5px;padding-left:5px;padding-top:0px;padding-bottom:0px;height:19px;}regular-table tr:hover td{background:#eee;opacity:1;}regular-table tr:hover{color:#333;}regular-table table *{box-sizing:border-box;}regular-table table{position:absolute;overflow:hidden;color:#666;outline:none;}regular-table span.rt-row-header-icon{color:#aaa;padding-right:4px;font-family:var(--button--font-family,"Material Icons");}regular-table span.rt-column-header-icon{font-size:10px;padding-left:3px;display:inline-block;width:10px;font-family:var(--button--font-family,"Material Icons");}regular-table span.rt-row-header-icon:hover{color:#1a7da1;text-shadow:0px 0px 3px#1a7da1;}regular-table .rt-selected td{background-color:#eee;}regular-table .rt-cell-clip{overflow:hidden;text-overflow:ellipsis;}regular-table td span.rt-group-name,regular-table th span.rt-group-name{margin-right:-5px;padding-right:5px;padding-left:8px;flex:1;height:100%;}regular-table th span.rt-group-name{text-align:left;}regular-table td th span.rt-group-leaf,regular-table th span.rt-group-leaf{margin-left:16px;height:100%;}regular-table .rt-column-resize{height:100%;width:10px;position:absolute;top:0;right:0;cursor:col-resize;}regular-table a{color:var(--rt-pos-cell--color);}regular-table a:visited{color:var(--active--color);}regular-table::-webkit-scrollbar,regular-table::-webkit-scrollbar-corner{background-color:transparent;height:12px;width:12px;}regular-table::-webkit-scrollbar-thumb{background-clip:content-box;background:var(--icon--color);border:5.5px solid var(--plugin--background);max-height:50%;max-width:50%;min-width:10%;min-height:10%;}.psp-header-border:not(.psp-is-top):not(.psp-header-leaf){box-shadow:1px 0px var(--inactive--border-color,#8b868045);}.psp-header-group{box-shadow:0px 10px 0 -9px var(--inactive--border-color,#8b868045);}.psp-is-top{box-shadow:5px 4px 0px -4px var(--inactive--border-color,#8b868045);}.psp-is-top.psp-header-group:not(.psp-header-group-corner){box-shadow:5px 4px 0px -4px var(--inactive--border-color,#8b868045),0px 10px 0 -9px var(--inactive--border-color,#8b868045);}.psp-header-border.psp-header-group:not(.psp-is-top):not(.psp-header-group-corner){box-shadow:1px 0px var(--inactive--border-color,#8b868045),0px 10px 0 -9px var(--inactive--border-color,#8b868045);}.psp-header-leaf.psp-header-border{box-shadow:5px -4px 0px -4px var(--inactive--border-color,#8b868045);}tr:only-child th{box-shadow:none!important;}regular-table tbody tr:hover th.psp-tree-leaf:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover th.psp-tree-label:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover td:not(.psp-row-selected):not(.psp-row-subselected){border-color:var(--rt-hover--border-color,#c5c9d080)!important;background-color:transparent;box-shadow:0px 1px 0px var(--rt-hover--border-color,#c5c9d080),0px 3px 0px rgba(0,0,0,0.05),0px 5px 0px rgba(0,0,0,0.01);}regular-table tbody tr:hover+tr th.psp-tree-leaf:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover+tr th.psp-tree-label:not(.psp-row-selected):not(.psp-row-subselected),regular-table tbody tr:hover+tr td:not(.psp-row-selected):not(.psp-row-subselected){border-top-color:transparent;}regular-table tbody tr th:first-child:not(:empty),regular-table tbody tr th:first-child:empty+th:not(:empty),regular-table tbody tr th:first-child:empty~th:empty+th:not(:empty),regular-table tbody tr td:first-child{border-left-width:1px;border-left-color:transparent;}regular-table tbody tr th:last-child,regular-table tbody tr td:last-child{border-right-width:1px;border-right-color:transparent;}regular-table tbody tr:hover{color:#161616;}regular-table tbody tr:hover th:first-child:not(:empty),regular-table tbody tr:hover th:first-child:empty+th:not(:empty),regular-table tbody tr:hover th:first-child:empty~th:empty+th:not(:empty),regular-table tbody tr:hover td:first-child{border-left-color:var(--rt-hover--border-color,#c5c9d080)!important;}regular-table tbody tr:hover th:last-child,regular-table tbody tr:hover td:last-child{border-right-color:var(--rt-hover--border-color,#c5c9d080)!important;}perspective-viewer[settings] regular-table .psp-header-leaf{height:36px;vertical-align:top;padding-top:3.5px;}perspective-viewer[settings] regular-table .psp-header-leaf:not(.psp-header-corner):before{font-family:var(--button--font-family,inherit);content:var(--column-style-open-button--content,var(--config-button-icon--content,"\\1f527"));position:absolute;width:calc(100% - 8px);left:5px;bottom:0px;padding-bottom:1px;margin-bottom:3px;color:var(--inactive--border-color,#8b868045);font-size:9px;border:1px solid transparent;border-radius:2px;}perspective-viewer[settings] regular-table .psp-header-leaf.psp-menu-enabled:not(.psp-header-corner):before{color:inherit;cursor:pointer;}perspective-viewer[settings] regular-table .psp-header-leaf.psp-menu-open:not(.psp-header-corner){pointer-events:none;}perspective-viewer[settings] regular-table .psp-header-leaf.psp-menu-open:not(.psp-header-corner):before{border:1px solid var(--inactive--border-color);content:var(--column-style-close-button--content,"X");}perspective-viewer[settings] regular-table .psp-header-leaf.psp-menu-enabled:hover:before{border:1px solid var(--inactive--border-color);}perspective-viewer[settings] regular-table .psp-header-leaf .rt-column-resize{height:18px;}.psp-row-selected,:hover .psp-row-selected,:hover th.psp-tree-leaf.psp-row-selected,:hover th.psp-tree-label.psp-row-selected{color:white!important;background-color:#ea7319!important;border-color:#ea7319!important;}.psp-row-selected.psp-tree-label:not(:hover):before{color:white;}.psp-row-subselected,:hover .psp-row-subselected,:hover th.psp-tree-leaf.psp-row-subselected,:hover th.psp-tree-label.psp-row-subselected{background:rgba(234,115,25,0.2)!important;}.psp-error{color:red;}td:focus{outline:#666;outline-style:dotted;outline-width:1px;}perspective-viewer.dragging regular-table{pointer-events:none;}.psp-header-border:last-child{border-right-width:0px;}.psp-header-sort-desc:after{background-repeat:no-repeat;background-color:var(--icon--color);content:"";display:inline-block;-webkit-mask-size:cover;mask-size:cover;width:14px;height:12px;-webkit-mask-image:var(--sort-desc-icon--mask-image);mask-image:var(--sort-desc-icon--mask-image);}.psp-header-sort-asc:after{background-repeat:no-repeat;background-color:var(--icon--color);content:"";display:inline-block;-webkit-mask-size:cover;mask-size:cover;width:14px;height:12px;-webkit-mask-image:var(--sort-asc-icon--mask-image);mask-image:var(--sort-asc-icon--mask-image);}.psp-header-sort-col-desc:after{background-repeat:no-repeat;background-color:var(--icon--color);content:"";display:inline-block;-webkit-mask-size:cover;mask-size:cover;width:14px;height:12px;-webkit-mask-image:var(--sort-col-desc-icon--mask-image);mask-image:var(--sort-col-desc-icon--mask-image);}.psp-header-sort-col-asc:after{background-repeat:no-repeat;background-color:var(--icon--color);content:"";display:inline-block;-webkit-mask-size:cover;mask-size:cover;width:14px;height:12px;-webkit-mask-image:var(--sort-col-asc-icon--mask-image);mask-image:var(--sort-col-asc-icon--mask-image);}tbody th:last-of-type{border-right:1px solid var(--inactive--border-color,#8b868045);overflow:hidden;text-overflow:ellipsis;}tbody th:empty{background-image:linear-gradient(to right,transparent 9px,#eee 10px,transparent 11px);background-repeat:no-repeat;min-width:20px;max-width:20px;pointer-events:none;}.psp-tree-label{max-width:0px;min-width:0px;}.psp-tree-label:before{color:var(--icon--color);font-family:var(--button--font-family,inherit);padding-right:11px;}.psp-tree-label-expand:before{content:var(--tree-label-expand--content,"+");}.psp-tree-label-collapse:before{content:var(--tree-label-collapse--content,"-");}.psp-tree-label-expand,.psp-tree-label-collapse{cursor:pointer;}.psp-tree-label:hover:before{color:var(--active--color);text-shadow:0px 0px 5px var(--active--color);}regular-table thead tr:last-child th{border-bottom-width:1px;border-bottom-color:var(--inactive--border-color,#8b868045);}.psp-tree-leaf{padding-left:24px;}.psp-align-right{text-align:right;}.psp-align-left{text-align:left;}.psp-positive:not(:focus){color:var(--rt-pos-cell--color);}.psp-negative:not(:focus){color:var(--rt-neg-cell--color);}regular-table table tbody td{min-width:52px!important;}.psp-is-width-override .rt-column-resize,.rt-column-resize:hover{border:1px dashed#999;border-bottom-width:0px;border-left-width:0px;}.psp-bool-type{font-family:var(--button--font-family,"Material Icons");}.boolean-editable{cursor:pointer;}regular-table table{user-select:none;color:#161616;border-collapse:separate;}regular-table table th{font-weight:400;}regular-table table td,regular-table table th{border-color:var(--inactive--border-color,#8b868045);height:23px;}regular-table table .psp-header-group{text-overflow:ellipsis;}regular-table table th.psp-header-leaf{border-bottom-width:0px;}regular-table table th.psp-header-leaf span{height:23px;min-height:23px;}regular-table table td,regular-table table th.psp-tree-label,regular-table table th.psp-tree-label,regular-table table th.psp-tree-leaf,regular-table table tbody tr:first-child th{border-style:solid;border-width:0px;border-top-width:1px;}regular-table table tbody th:empty{background-position:0px -10px;}@keyframes pulse_pos{0%{background-color:var(--pulse--background-color-start,rgba(0,128,255,0.5));}100%{background-color:var(--pulse--background-color-end,rgba(0,128,255,0));}}@keyframes pulse_pos2{0%{background-color:var(--pulse--background-color-start,rgba(0,128,255,0.5));}100%{background-color:var(--pulse--background-color-end,rgba(0,128,255,0));}}@keyframes pulse_neg{0%{background-color:var(--pulse--background-color-start,rgba(255,25,0,0.5));}100%{background-color:var(--pulse--background-color-end,rgba(255,25,0,0));}}@keyframes pulse_neg2{0%{background-color:var(--pulse--background-color-start,rgba(255,25,0,0.5));}100%{background-color:var(--pulse--background-color-end,rgba(255,25,0,0));}}';function Ne(e){return e.x>=0?this._column_types[e.x]:this._row_header_types[e.row_header_x-1]}function Z(e){let t=e._view_cache.config.row_pivots.length-1,r=Array.from(e.children[0].children[0].children);if(r.length>0){let[s]=r.splice(r.length-1,1);for(let o of s?.children){let l=e.getMeta(o),i=l.column_header?.[l.column_header?.length-1],n=this._config.sort.find(_=>_[0]===i),a=l.row_header_x===t,c=typeof l.x>"u";a=a||(l.x+1)%this._config.columns.length===0,o.classList.toggle("psp-header-border",a),o.classList.toggle("psp-header-group",!1),o.classList.toggle("psp-header-leaf",!0),o.classList.toggle("psp-is-top",!1),o.classList.toggle("psp-header-corner",c),o.classList.toggle("psp-header-sort-asc",!!n&&n[1]==="asc"),o.classList.toggle("psp-header-sort-desc",!!n&&n[1]==="desc"),o.classList.toggle("psp-header-sort-col-asc",!!n&&n[1]==="col asc"),o.classList.toggle("psp-header-sort-col-desc",!!n&&n[1]==="col desc");let d=Ne.call(this,l),h=d==="integer"||d==="float",f=d==="string",p=d==="date",g=d==="datetime";o.classList.toggle("psp-align-right",h),o.classList.toggle("psp-align-left",!h),o.classList.toggle("psp-menu-open",this._open_column_styles_menu[0]===l._virtual_x),o.classList.toggle("psp-menu-enabled",(f||h||p||g)&&!c),o.classList.toggle("psp-is-width-override",e._column_sizes?.override[l.size_key]!==void 0)}}}function Q(e){let t=e._view_cache.config.row_pivots.length-1,r=Array.from(e.children[0].children[0].children),s=[],o=new Set,l=e.children[0];for(let i=0;i<r.length;i++){let n=l.rows[i],a=new Set;for(let c=0;c<n.cells.length;c++){let d=n.cells[c];d.style.backgroundColor="";let h=e.getMeta(d),f=h.row_header_x===t||h.x>=0;d.classList.toggle("psp-align-right",!1),d.classList.toggle("psp-align-left",!1),d.classList.toggle("psp-header-group",!0),d.classList.toggle("psp-header-leaf",!1),d.classList.toggle("psp-header-border",f),d.classList.toggle("psp-header-group-corner",typeof h.x>"u"),d.classList.toggle("psp-color-mode-bar",!1),d.classList.toggle("psp-header-sort-asc",!1),d.classList.toggle("psp-header-sort-desc",!1),d.classList.toggle("psp-header-sort-col-asc",!1),d.classList.toggle("psp-header-sort-col-desc",!1);let p=n.cells[c],g=c,_,y;for(;s[i]&&s[i][g];++g);for(a.add(g),_=g;_<g+p.colSpan;++_)for(y=i;y<i+p.rowSpan;++y)s[y]||(s[y]=[]),s[y][_]=!0;p.classList.toggle("psp-is-top",i===0||!o.has(_))}o=a}}var v=Symbol("Plugin Symbol");function ee(e,t,[,,,,,r,s],[,,,,,o,l]){let i=this._ids?.[e.dy]?.join("|"),n=e.column_header.join("|");if(this.last_reverse_columns?.has(n)&&this.last_reverse_ids?.has(i)){let a=this.last_reverse_ids?.get(i),c=this.last_reverse_columns.get(n);this._is_old_viewport?this.last_meta?.[c]?.[a]>e.user?(t.style.setProperty("--pulse--background-color-start",o),t.style.setProperty("--pulse--background-color-end",l),t.style.animationName==="pulse_neg"?t.style.animation="pulse_neg2 0.5s linear":t.style.animation="pulse_neg 0.5s linear"):this.last_meta?.[c]?.[a]<e.user?(t.style.setProperty("--pulse--background-color-start",r),t.style.setProperty("--pulse--background-color-end",s),t.style.animationName==="pulse_pos"?t.style.animation="pulse_pos2 0.5s linear":t.style.animation="pulse_pos 0.5s linear"):a!==e.dy&&(t.style.animation=""):t.style.animation=""}else t.style.animation=""}import te from"chroma-js";function T(e,t){return te.mix(e,`rgb(${t[0]},${t[1]},${t[2]})`,.5).hex()}function L([e,t,r,s],o=[255,255,255]){function l(i,n){return((1-s)*(o[i]/255)+s*(n/255))*255}return[l(0,e),l(1,t),l(2,r)]}function E([e,t,r]){return Math.sqrt(e*e*.299+t*t*.587+r*r*.114)>130?"#161616":"#ffffff"}function De(e){let[t,r,s]=e.rgb(),[o,l,i]=e.set("hsl.h",(e.get("hsl.h")-15)%360).rgb(),[n,a,c]=e.set("hsl.h",(e.get("hsl.h")+15)%360).rgb();return`linear-gradient(to right top,rgb(${o},${l},${i}),rgb(${t},${r},${s}) 50%,rgb(${n},${a},${c}))`}function m(e){let t=te(e),r=De(t),s=t.rgb();return[e,...s,r,`rgba(${s[0]},${s[1]},${s[2]},1)`,`rgba(${s[0]},${s[1]},${s[2]},0)`]}function oe(e,t,r){let s=r.user>0,o=r.user<0,l;e?.pos_bg_color!==void 0?l=e.pos_bg_color:l=this._pos_bg_color;let i;e?.neg_bg_color!==void 0?i=e.neg_bg_color:i=this._neg_bg_color;let n=s?l:o?i:["",...this._plugin_background,""];{let[p,g,_,y,u]=n;if(t.style.position="",e?.number_bg_mode==="color")t.style.animation="",t.style.backgroundColor=p;else if(e?.number_bg_mode==="gradient"){let b=Math.max(0,Math.min(1,Math.abs(r.user/e.bg_gradient))),x=this._plugin_background,w=E(L([g,_,y,b],x));t.style.animation="",t.style.color=w,t.style.backgroundColor=`rgba(${g},${_},${y},${b})`}else e?.number_bg_mode==="pulse"?(ee.call(this,r,t,l,i),t.style.backgroundColor=""):(e?.number_bg_mode==="disabled"||e?.number_bg_mode,t.style.animation="",t.style.backgroundColor="")}let[a,c,d,h,f]=(()=>e?.pos_fg_color!==void 0?s?e.pos_fg_color:o?e.neg_fg_color:["",...this._plugin_background,""]:s?this._pos_fg_color:o?this._neg_fg_color:["",...this._plugin_background,""])();if(e?.number_fg_mode==="disabled")if(e?.number_bg_mode==="color"){let p=this._plugin_background,g=E(L([n[1],n[2],n[3],1],p));t.style.color=g}else e?.number_bg_mode==="gradient"||(t.style.color="");else e?.number_fg_mode==="bar"?(t.style.color="",t.style.position="relative",f!==""&&t.children.length>0&&t.children[0].nodeType===Node.ELEMENT_NODE&&(t.children[0].style.background=f)):(e?.number_fg_mode==="color"||!e?.number_fg_mode)&&(t.style.color=a)}import re from"chroma-js";function se(e,t,r){let s=r.column_header?.[r.column_header?.length-1],[o,l,i,n,a]=(()=>e?.color!==void 0?e.color:this._color)();if(e?.string_color_mode==="foreground"&&r.user!==null)t.style.color=o,t.style.backgroundColor="",e?.format==="link"&&(t.children[0].style.color=o);else if(e?.string_color_mode==="background"&&r.user!==null){let c=this._plugin_background,d=E(L([l,i,n,1],c));t.style.color=d,t.style.backgroundColor=o}else if(e?.string_color_mode==="series"&&r.user!==null){this._series_color_map.has(s)||(this._series_color_map.set(s,new Map),this._series_color_seed.set(s,0));let c=this._series_color_map.get(s);if(!c.has(r.user)){let S=this._series_color_seed.get(s);c.set(r.user,S),this._series_color_seed.set(s,S+1)}let d=c.get(r.user),[h,f,p]=re(o).hsl();h=h+d*150%360;let g=re(h,f,p,"hsl"),[_,y,u]=g.rgb(),b=g.hex(),x=this._plugin_background,w=E(L([_,y,u,1],x));t.style.color=w,t.style.backgroundColor=b}else t.style.backgroundColor="",t.style.color=""}import"chroma-js";function le(e,t,r){let s=r.column_header?.[r.column_header?.length-1],[o,l,i,n,a]=(()=>e?.color!==void 0?e.color:this._color)();if(e?.datetime_color_mode==="foreground"&&r.user!==null)t.style.color=o,t.style.backgroundColor="";else if(e?.datetime_color_mode==="background"&&r.user!==null){let c=this._plugin_background,d=E(L([l,i,n,1],c));t.style.color=d,t.style.backgroundColor=o}else t.style.backgroundColor="",t.style.color=""}function ie(e,t,r){let[s]=r.user===!0?this._pos_fg_color:r.user===!1?this._neg_fg_color:["",0,0,0,""];t.style.backgroundColor="",t.style.color=s}function ne(e,t,r){let s=typeof r.value!=null&&typeof r.value!=null&&r.value?.toString()?.trim().length>0,o=r.row_header_x>=this._config.group_by.length,l=e.getMeta({dx:0,dy:r.y-r.y0+1}),i=l&&l.row_header&&typeof l.row_header[r.row_header_x+1]<"u";t.classList.toggle("psp-tree-label",s&&!o),t.classList.toggle("psp-tree-label-expand",s&&!o&&!i),t.classList.toggle("psp-tree-label-collapse",s&&!o&&i),t.classList.toggle("psp-tree-leaf",s&&o)}function $e(e){return e.x>=0?this._column_types[e.x]:this._row_header_types[e.row_header_x-1]}function ae(e){let t=e[v]||{};for(let r of e.children[0].children[1].children)for(let s of r.children){let o=e.getMeta(s),l=o.column_header?.[o.column_header?.length-1],i=$e.call(this,o),n=t[l],a=i==="integer"||i==="float";a?oe.call(this,n,s,o):i==="boolean"?ie.call(this,n,s,o):i==="string"?se.call(this,n,s,o):i==="date"||i==="datetime"?le.call(this,n,s,o):(s.style.backgroundColor="",s.style.color=""),s.classList.toggle("psp-bool-type",i==="boolean"&&o.user!==null);let c=s.tagName==="TH";c&&ne.call(this,e,s,o),s.classList.toggle("psp-align-right",!c&&a),s.classList.toggle("psp-align-left",c||!a),s.classList.toggle("psp-color-mode-bar",n?.number_fg_mode==="bar"&&a)}}async function ce(e,t,r){let s=e.getMeta(r),o=s.column_header[s.column_header.length-1],i=(t.shiftKey?Fe:He).call(this,o);this._preserve_focus_state=!0,await e.parentElement.parentElement.restore({sort:i})}function Fe(e){let t=[],r=!1;for(let s of this._config.sort){let[o,l]=s;if(o===e){r=!0;let i=de.call(this,e,l);i&&t.push(i)}else t.push(s)}return r||t.push([e,"desc"]),t}function He(e){for(let[t,r]of this._config.sort)if(t===e){let s=de.call(this,e,r);return s?[s]:[]}return[[e,"desc"]]}function de(e,t){let s=this._config.split_by.length>0?Be:je,o=t?s[t]:"desc";if(o)return[e,o]}var je={desc:"asc",asc:void 0},Be={desc:"asc",asc:"col desc","col desc":"col asc","col asc":void 0};function Y(e,t,r){let s=e.getMeta(t),o=s.column_header[s.column_header.length-1],l=this._schema[o],i=l==="integer"||l==="float",n=document.createElement(`perspective-${{float:"number",integer:"number",string:"string",date:"date",datetime:"datetime"}[l]}-column-style`),a;if(i?a={fg_gradient:r,pos_fg_color:this._pos_fg_color[0],neg_fg_color:this._neg_fg_color[0],number_fg_mode:"color",bg_gradient:r,pos_bg_color:this._pos_bg_color[0],neg_bg_color:this._neg_bg_color[0],number_bg_mode:"disabled"}:a={color:this._color[0],bg_color:this._color[0]},!(l==="string"||l==="date"||l==="datetime"))if(l==="float")a.fixed=2;else if(l==="integer")a.fixed=0;else{this._open_column_styles_menu.pop(),t.classList.remove("psp-menu-open");return}let c=()=>n.blur(),d=g=>{let _=g.detail;_.pos_fg_color&&(_.pos_fg_color=m(_.pos_fg_color),_.neg_fg_color=m(_.neg_fg_color)),_.pos_bg_color&&(_.pos_bg_color=m(_.pos_bg_color),_.neg_bg_color=m(_.neg_bg_color)),_.color&&(_.color=m(_.color)),_.bg_color&&(_.bg_color=m(_.bg_color)),e[v]=e[v]||{},e[v][o]=_,e.draw({preserve_width:!0}),e.parentElement.parentElement.dispatchEvent(new Event("perspective-config-update"))},h=async()=>{e.removeEventListener("regular-table-scroll",c),n.removeEventListener("perspective-column-style-change",d),n.removeEventListener("blur",h),this._open_column_styles_menu.pop(),e.parentElement.parentElement.dispatchEvent(new Event("perspective-config-update")),t.classList.remove("psp-menu-open"),n.destroy()};n.addEventListener("perspective-column-style-change",d),n.addEventListener("blur",h),e.addEventListener("regular-table-scroll",c);let f=e[v]||{},p=Object.assign({},f[o]=f[o]||{});(p.pos_fg_color||p.pos_bg_color)&&(p.pos_fg_color=p.pos_fg_color?.[0],p.neg_fg_color=p.neg_fg_color?.[0],p.pos_bg_color=p.pos_bg_color?.[0],p.neg_bg_color=p.neg_bg_color?.[0]),p.color&&(p.color=p.color[0]),p.bg_color&&(p.bg_color=p.bg_color[0]),n.open(t,p,a)}async function pe(e,t){let r=e.getMeta(t.target),s=t.target.classList.contains("psp-tree-label-collapse");t.shiftKey&&s?this._view.set_depth(r.row_header.filter(o=>o!==void 0).length-2):t.shiftKey?this._view.set_depth(r.row_header.filter(o=>o!==void 0).length-1):s?this._view.collapse(r.y):this._view.expand(r.y),this._num_rows=await this._view.num_rows(),this._num_columns=await this._view.num_columns(),e.draw()}async function _e(e,t){if(t.which!==1)return;let r=t.target;if(r.tagName==="A")return;for(;r.tagName!=="TD"&&r.tagName!=="TH";)if(r=r.parentElement,!e.contains(r))return;if(r.classList.contains("psp-tree-label")){pe.call(this,e,t),t.stopImmediatePropagation();return}let s=r.getBoundingClientRect();if(r.classList.contains("psp-menu-enabled")&&t.clientY-s.top>16){r.classList.add("psp-menu-open");let o=e.getMeta(r),l=o.column_header?.[o.column_header?.length-1],i=this._schema[l];if(this._open_column_styles_menu.unshift(o._virtual_x),i==="string"||i==="date"||i==="datetime")Y.call(this,e,r);else{let[n,a]=await this._view.get_min_max(l),c=Math.max(Math.abs(n),Math.abs(a));c>1&&(c=Math.round(c*100)/100),Y.call(this,e,r,c)}t.preventDefault(),t.stopImmediatePropagation()}else r.classList.contains("psp-header-leaf")&&!r.classList.contains("psp-header-corner")&&(ce.call(this,e,t,r),t.stopImmediatePropagation())}function ge(e,t){if(t.which!==1)return;let r=t.target;for(;r.tagName!=="TD"&&r.tagName!=="TH";)if(r=r.parentElement,!e.contains(r))return;(r.classList.contains("psp-tree-label")&&t.offsetX<26||r.classList.contains("psp-header-leaf")&&!r.classList.contains("psp-header-corner"))&&t.stopImmediatePropagation()}function he(e,t=!1){let r=this._config.group_by.length===0&&this._config.split_by.length===0,s=e.hasAttribute("selectable"),o=t||!!e.children[0]._is_edit_mode;return r&&!s&&o}function ue(e,t){let r=e[v]||{},s=he.call(this,t);e.parentElement.classList.toggle("edit-mode-allowed",he.call(this,t,!0));for(let o of e.querySelectorAll("td")){let l=e.getMeta(o),i=this.get_psp_type(l);if(s&&this._is_editable[l.x]){let n=l.column_header[l.column_header.length-1];i==="string"&&r[n]?.format==="link"?(o.toggleAttribute("contenteditable",!1),o.classList.toggle("boolean-editable",!1)):i==="boolean"?(o.toggleAttribute("contenteditable",!1),o.classList.toggle("boolean-editable",l.user!==null)):(s!==o.hasAttribute("contenteditable")&&o.toggleAttribute("contenteditable",s),o.classList.toggle("boolean-editable",!1))}else o.toggleAttribute("contenteditable",!1),o.classList.toggle("boolean-editable",!1)}}var A=(e,t,r)=>{let s=e.querySelectorAll("td"),o=r.get(e);if(o){for(let l of s){let i=e.getMeta(l);if(i.x===o.x&&i.y===o.y)return document.activeElement!==l&&l.focus({preventScroll:!0}),!0}document.activeElement!==document.body&&e.contains(document.activeElement)&&document.activeElement.blur()}};function Te(e){let t;return async function(...r){if(!!t&&await t&&!!t)return;let s;t=new Promise(o=>s=o),await e.apply(this,r),t=void 0,s()}}function fe(){if(this.isContentEditable){let e=document.getSelection().getRangeAt(0),t=e.cloneRange();return t.selectNodeContents(this),t.setEnd(e.endContainer,e.endOffset),t.toString().length}else return this.target.selectionStart}function V(e,t,r){let s=e.getMeta(r),o=t._schema[t._column_paths[s.x]];if(s){let l=r.textContent,i=t._ids[s.y-s.y0];if(o==="float"||o==="integer"){if(l=parseFloat(l.replace(/,/g,"")),isNaN(l))return!1}else if(o==="date"||o==="datetime"){if(l=Date.parse(l),isNaN(l))return!1}else o==="boolean"&&(l=l==="check"?!1:l==="close"?!0:null);let n={__INDEX__:i,[t._column_paths[s.x]]:l};return t._table.update([n],{port_id:t._edit_port}),!0}}function O(e,t=!1){let r=this._config.group_by.length===0&&this._config.split_by.length===0,s=e.hasAttribute("selectable"),o=t||!!e.children[0]._is_edit_mode;return r&&!s&&o}var C=Te(async function(e,t,r,s,o){let l=e.getMeta(r),i=this._column_paths.length,n=this._num_rows,a=t.get(e);if(!a)return;l.x+s<i&&0<=l.x+s&&(a.x=l.x+s),l.y+o<n&&0<=l.y+o&&(a.y=l.y+o);let c=Math.max(l.x0-10,0),d=Math.min(l.x0+10,i),h=Math.max(l.y0-5,0),f=Math.min(l.y0+10,n),p=l.x0+s,g=l.y0+o;for(;!A(e,void 0,t)&&p>=c&&p<d&&g>=h&&g<f;)await e.scrollToCell(p,g,i,n),t.set(e,a),p+=s,g+=o});function be(e,t,r,s){if(!O.call(this,t))return;let o=document.activeElement;switch(s.target.classList.remove("psp-error"),s.keyCode){case 13:s.preventDefault(),s.shiftKey?C.call(this,e,r,o,0,-1):C.call(this,e,r,o,0,1);break;case 37:fe.call(o)==0&&(s.preventDefault(),C.call(this,e,r,o,-1,0));break;case 38:s.preventDefault(),C.call(this,e,r,o,0,-1);break;case 39:fe.call(o)==o.textContent.length&&(s.preventDefault(),C.call(this,e,r,o,1,0));break;case 40:s.preventDefault(),C.call(this,e,r,o,0,1);break;default:}}function me(e,t,r){let s=e.getMeta(r.target);if(typeof s?.x<"u"){let o=O.call(this,t),l=this._is_editable[s.x],i=this.get_psp_type(s)==="boolean",n=r.target.textContent==="-";o&&l&&i&&!n&&V(e,this,r.target)}}function ye(e,t,r,s){if(O.call(this,t)&&r.has(e)){s.target.classList.remove("psp-error");let o=r.get(e);r.delete(e),o.content!==s.target.textContent&&(V(e,this,s.target)||(s.target.textContent=o.content,s.target.classList.add("psp-error"),s.target.focus()))}}function xe(e,t,r,s){let o=e.getMeta(s.target);if(o){let l={x:o.x,y:o.y,content:s.target.textContent};r.set(e,l)}}async function M({_view:e,_config:t},r,s){let o=t.group_by,l=t.split_by,i=r>=0?r:0,n=i+1,a=await e.to_json({start_row:i,end_row:n}),d=a.map(u=>u.__ROW_PATH__)[0]||[],h=o.map((u,b)=>{let x=d[b];return x?[u,"==",x]:void 0}).filter(u=>u),f=o.length>0?s+1:s,p=Object.keys(a[0])[f],g={row:a[0]},_=[];if(p){let u=p.split("|");g.column_names=[u[u.length-1]],_=l.map((b,x)=>{let w=u[x];return w?[b,"==",w]:void 0}).filter(b=>b).filter(([,,b])=>b!=="__ROW_PATH__")}let y=t.filter.concat(h).concat(_);return g.config={filter:y},g}async function ve(e,t,r,s){let o=e.getMeta(s.target);if(!t.hasAttribute("selectable")||s.handled||s.which!==1||!o)return;let l=this._ids[o.y-o.y0];if(o&&o.y>=0){let i=r.get(e),n=!!i&&i.reduce((p,g,_)=>p&&g===l[_],!0),a=!!i&&l.length===i.length&&n,c={selected:!a},{row:d,column_names:h,config:f}=await M(this,o.y,o.x);a?(r.delete(e),c={...c,row:d,config:{filter:structuredClone(this._config.filter)}}):(r.set(e,l),c={...c,row:d,column_names:h,config:f}),await e.draw({preserve_width:!0}),s.handled=!0,t.dispatchEvent(new CustomEvent("perspective-select",{bubbles:!0,composed:!0,detail:c}))}}function we(e,t,r){if(!t.hasAttribute("selectable"))return;let s=r.has(e),o=r.get(e);for(let l of e.querySelectorAll("td"))if(!s)l.classList.toggle("psp-row-selected",!1),l.classList.toggle("psp-row-subselected",!1);else{let i=e.getMeta(l),n=this._ids[i.y-i.y0],a=o.reduce((c,d,h)=>c&&d===n[h],!0);l.classList.toggle("psp-row-selected",n.length===o.length&&a),l.classList.toggle("psp-row-subselected",n.length!==o.length&&a)}for(let l of e.querySelectorAll("tbody th")){let i=e.getMeta(l),n=this._ids[i.y-i.y0];if(!s||!!n[i.row_header_x])l.classList.toggle("psp-row-selected",!1),l.classList.toggle("psp-row-subselected",!1);else{let a=o.reduce((c,d,h)=>c&&d===n[h],!0);l.classList.toggle("psp-row-selected",n.length===o.length&&a),l.classList.toggle("psp-row-subselected",n.length!==o.length&&a)}}}async function ke(e,t,r){r.delete(e);for(let s of e.querySelectorAll("td,th"))s.classList.toggle("psp-row-selected",!1),s.classList.toggle("psp-row-subselected",!1)}import Ve from"chroma-js";import{get_type_config as P}from"@finos/perspective/src/js/config/index.js";var Le={datetime:Intl.DateTimeFormat,date:Intl.DateTimeFormat,integer:Intl.NumberFormat,float:Intl.NumberFormat,boolean:class{format(e){return e?"check":"close"}}},R=class{constructor(){this._formatters=new Map}create_datetime_formatter(t,r){let s=P(t),o={...s.format,timeZone:r.timeZone,dateStyle:r.dateStyle,timeStyle:r.timeStyle};return o.dateStyle==="disabled"?o.dateStyle=void 0:o.dateStyle===void 0&&(o.dateStyle=s.format.dateStyle),o.timeStyle==="disabled"?o.timeStyle=void 0:o.timeStyle===void 0&&(o.timeStyle=s.format.timeStyle),new Intl.DateTimeFormat([],o)}create_number_formatter(t,r){let{format:s}=P(t);return r.fixed!==void 0&&(s.minimumFractionDigits=r.fixed,s.maximumFractionDigits=r.fixed),new Le[t]([],s)}create_boolean_formatter(t,r){let s=P(t);return new Le[t]([],s.format)}get(t,r){let s=[t,r.fixed,r.timeZone,r.dateStyle,r.timeStyle].join("-");if(!this._formatters.has(s)){let o=P(t);t==="date"||t==="datetime"?this._formatters.set(s,this.create_datetime_formatter(t,r)):t==="integer"||t==="float"?this._formatters.set(s,this.create_number_formatter(t,r)):t==="boolean"?this._formatters.set(s,this.create_boolean_formatter(t,r)):this._formatters.set(s,!1)}return this._formatters.get(s)}};var Ye=new R;function I(e,t,r={},s=!1){if(t===null)return"-";let o=e[e.length-1],l=s&&this._table_schema[o]||this._schema[o]||"string",i=r[o]||{};if((l==="integer"||l==="float")&&i?.number_fg_mode==="bar"){let a=Math.max(0,Math.min(.95,Math.abs(t/i.fg_gradient)*.95)),c=this._div_factory.get(),d=t>=0?"left":"right";return c.setAttribute("style",`width:${(a*100).toFixed(2)}%;position:absolute;${d}:0;height:80%;top:10%;pointer-events:none;`),c}else if(i?.format==="link"&&l==="string"){let a=document.createElement("a");return a.setAttribute("href",t),a.setAttribute("target","_blank"),a.textContent=t,a}else if(i?.format==="bold"&&l==="string"){let a=document.createElement("b");return a.textContent=t,a}else if(i?.format==="italics"&&l==="string"){let a=document.createElement("i");return a.textContent=t,a}else{let a=Ye.get(l,i);return a?a.format(t):t}}function*Ee(e=[],t,r){let s=r[v];for(let o of e){o=["TOTAL",...o];let l=o[o.length-1];o=o.slice(0,o.length-1).fill("");let i=I.call(this,[t[o.length-1]],l,s,!0);i instanceof HTMLElement?o=o.concat(i):o=o.concat({toString:()=>i}),o.length=t.length+1,yield o}}function Se(){let e,t,r,s,o;return async function(i,n,a,c,d){let h={},f;c-n>0&&d-a>0?(this._is_old_viewport=this._last_window?.start_row===a&&this._last_window?.end_row===d&&this._last_window?.start_col===n&&this._last_window?.end_col===c,f={start_row:a,start_col:n,end_row:d,end_col:c,id:!0},h=await this._view.to_columns(f),this._last_window=f,this._ids=h.__ID__,this._reverse_columns=this._column_paths.slice(n,c).reduce((u,b,x)=>(u.set(b,x),u),new Map),this._reverse_ids=this._ids.reduce((u,b,x)=>(u.set(b?.join("|"),x),u),new Map)):this._div_factory.clear();let p=[],g=[],_=[],y=[];for(let u=n;u<Math.min(c,this._column_paths.length);++u){let b=this._column_paths[u],x=b.split("|"),w=h[b]||new Array(d-a).fill(null);p.push(w.map(S=>I.call(this,x,S,i[v]))),g.push(w),_.push(x),y.push(b)}return c-n>0&&d-a>0&&(this.last_column_paths=t,this.last_meta=e,this.last_ids=r,this.last_reverse_ids=s,this.last_reverse_columns=o,t=y,e=g,r=this._ids,s=this._reverse_ids,o=this._reverse_columns),{num_rows:this._num_rows,num_columns:this._column_paths.length,row_headers:Array.from(Ee.call(this,h.__ROW_PATH__,this._config.group_by,i)),column_headers:_,data:p,metadata:g}}}function N(e,t,r){let s=window.getComputedStyle(e).getPropertyValue(t).trim();return s.length>0?s:r}var W=class{constructor(t){this._name=t,this._elements=[],this._index=0}clear(){this._index=0}get(){this._elements[this._index]||(this._elements[this._index]=document.createElement(this._name));let t=this._elements[this._index];return this._index+=1,t}};function We(e){return e.x>=0?this._column_types[e.x]:this._row_header_types[e.row_header_x-1]}async function q(e,t,r,s={}){let o=await r.get_config(),l=o.expressions.map(k=>k[1]),[i,n,a,c,d,h,f]=await Promise.all([t.schema(),t.validate_expressions(l),r.num_rows(),r.schema(),r.expression_schema(),r.column_paths(),this.parentElement.getEditPort()]),p=Ve(N(e,"--plugin--background","#FFFFFF")).rgb(),g=m(N(e,"--rt-pos-cell--color","#338DCD")),_=m(N(e,"--rt-neg-cell--color","#FF5942")),y=m(T(g[0],p)),u=m(T(_[0],p)),b=m(N(e,"--active--color","#ff0000")),x={...c,...d},w={...i,...n.expression_schema},S=h.filter(k=>k!=="__ROW_PATH__"&&k!=="__ID__"),U=[],G=[];for(let k of S){let J=k.split("|"),K=J[J.length-1];G.push(x[K]),U.push(!!i[K])}let z=Object.assign(s,{_edit_port:f,_view:r,_table:t,_table_schema:w,_config:o,_num_rows:a,_schema:x,_ids:[],_open_column_styles_menu:[],_plugin_background:p,_color:b,_pos_fg_color:g,_neg_fg_color:_,_pos_bg_color:y,_neg_bg_color:u,_column_paths:S,_column_types:G,_is_editable:U,_row_header_types:o.group_by.map(k=>w[k]),_series_color_map:new Map,_series_color_seed:new Map,get_psp_type:We});return z._div_factory=z._div_factory||new W("div"),e.setDataListener(Se().bind(z,e),{virtual_mode:window.getComputedStyle(e).getPropertyValue("--datagrid-virtual-mode")?.trim()||"both"}),z}async function Ce(e,t,r){let s=e.getMeta(r.target);if(!s)return;let{x:o,y:l}=s,{row:i,column_names:n,config:a}=await M(this,l,o);t.dispatchEvent(new CustomEvent("perspective-click",{bubbles:!0,composed:!0,detail:{row:i,column_names:n,config:a}}))}async function Me(e){let t=this.parentElement,r=await t.getTable(!0);if(this._initialized)await q.call(this,this.regular_table,r,e,this.model);else{this.innerHTML="",this.appendChild(this.regular_table),this.model=await q.call(this,this.regular_table,r,e),this.regular_table.addStyleListener(ae.bind(this.model,this.regular_table)),this.regular_table.addStyleListener(Q.bind(this.model,this.regular_table)),this.regular_table.addStyleListener(Z.bind(this.model,this.regular_table)),this.regular_table.addEventListener("click",ge.bind(this.model,this.regular_table)),this.regular_table.addEventListener("mousedown",_e.bind(this.model,this.regular_table));let s=new WeakMap;this.regular_table.addStyleListener(we.bind(this.model,this.regular_table,t,s)),this.regular_table.addEventListener("mousedown",ve.bind(this.model,this.regular_table,t,s)),this.regular_table.addEventListener("psp-deselect-all",ke.bind(this.model,this.regular_table,t,s)),this.regular_table.addEventListener("click",Ce.bind(this.model,this.regular_table,t));let o=new WeakMap;this.regular_table.addStyleListener(ue.bind(this.model,this.regular_table,t)),this.regular_table.addStyleListener(A.bind(this.model,this.regular_table,t,o)),this.regular_table.addEventListener("click",me.bind(this.model,this.regular_table,t)),this.regular_table.addEventListener("focusin",xe.bind(this.model,this.regular_table,t,o)),this.regular_table.addEventListener("focusout",ye.bind(this.model,this.regular_table,t,o)),this.regular_table.addEventListener("keydown",be.bind(this.model,this.regular_table,t,o)),this._initialized=!0}}function D(e,t=!1){if(!this._initialized)return;t&&(this._cached_column_sizes=e);let r={},{group_by:s,columns:o}=this.model._config,l=s?.length>0?s.length+1:0;for(let i of Object.keys(e))if(i==="__ROW_PATH__")r[l-1]=e[i];else{let n=this.model._column_paths.indexOf(i);r[n+l]=e[i]}this.regular_table._column_sizes.override=r}function $(){if(!this._initialized)return[];if(this._cached_column_sizes){let l=this._cached_column_sizes;return this._cached_column_sizes=void 0,l}let e=this.regular_table._column_sizes.override,{group_by:t,columns:r}=this.model._config,s=t?.length>0?t.length+1:0,o={};for(let l of Object.keys(e))if(e[l]!==void 0){let i=l-s;i>-1?o[this.model._column_paths[i]]=e[l]:i===-1&&(o.__ROW_PATH__=e[l])}return o}function F(e=void 0){typeof e>"u"&&(e=!this._is_edit_mode),this._is_edit_mode=e,this.classList.toggle("editable",e),this._edit_mode!==void 0&&(this._edit_mode.classList.toggle("editable",e),e?this._edit_mode.children[0].textContent="Editable":this._edit_mode.children[0].textContent="Read Only")}function H(e=void 0){typeof e>"u"&&(e=!this._is_scroll_lock),this._is_scroll_lock=e,this.classList.toggle("sub-cell-scroll-disabled",e),this._scroll_lock!==void 0&&(this._scroll_lock.classList.toggle("lock-scroll",e),e?this._scroll_lock.children[0].textContent="Align Scroll":this._scroll_lock.children[0].textContent="Free Scroll")}function ze(e){e=JSON.parse(JSON.stringify(e));let t={};if(e.columns)for(let s of Object.keys(e.columns)){let o=e.columns[s];o.column_size_override!==void 0&&(t[s]=o.column_size_override,delete o.column_size_override),o?.pos_fg_color&&(o.pos_fg_color=m(o.pos_fg_color),o.neg_fg_color=m(o.neg_fg_color)),o?.pos_bg_color&&(o.pos_bg_color=m(o.pos_bg_color),o.neg_bg_color=m(o.neg_bg_color)),o?.color&&(o.color=m(o.color)),Object.keys(o).length===0&&delete e.columns[s]}"editable"in e&&F.call(this,e.editable),"scroll_lock"in e&&H.call(this,e.scroll_lock);let r=this.regular_table;try{r._resetAutoSize()}catch{}D.call(this,t,!0),r[v]=e.columns}function Ae(){this._toolbar||(this._toolbar=document.createElement("perspective-viewer-datagrid-toolbar")),this.parentElement.appendChild(this._toolbar)}function Oe(){if(this.regular_table){let e=this.regular_table,t={columns:{},scroll_lock:!!this._is_scroll_lock,editable:!!this._is_edit_mode};for(let s of Object.keys(e[v]||{})){let o=Object.assign({},e[v][s]);(o?.pos_fg_color||o?.pos_bg_color)&&(o.pos_fg_color=o.pos_fg_color?.[0],o.neg_fg_color=o.neg_fg_color?.[0],o.pos_bg_color=o.pos_bg_color?.[0],o.neg_bg_color=o.neg_bg_color?.[0]),o?.color&&(o.color=o.color[0]),t.columns[s]=o}let r=$.call(this);for(let s of Object.keys(r||{}))t.columns[s]||(t.columns[s]={}),t.columns[s].column_size_override=r[s];return JSON.parse(JSON.stringify(t))}return{}}async function Pe(e){if(this.parentElement&&await this.activate(e),!this.isConnected||this.offsetParent==null)return;let t=$.call(this),r=this.regular_table.draw({invalid_columns:!0});this.model._preserve_focus_state?this.model._preserve_focus_state=!1:(this.regular_table.scrollTop=0,this.regular_table.scrollLeft=0,this.regular_table.dispatchEvent(new CustomEvent("psp-deselect-all",{bubbles:!1})),this.regular_table._resetAutoSize()),D.call(this,t),await r,this._toolbar.classList.toggle("aggregated",this.model._config.group_by.length>0||this.model._config.split_by.length>0)}var j=class extends HTMLElement{constructor(){super(),this.regular_table=document.createElement("regular-table"),this._is_scroll_lock=!1}connectedCallback(){return Ae.call(this)}disconnectedCallback(){this._toolbar.parentElement.removeChild(this._toolbar)}async activate(t){return await Me.call(this,t)}get name(){return"Datagrid"}get category(){return"Basic"}get select_mode(){return"toggle"}get min_config_columns(){}get config_column_names(){return["Columns"]}get priority(){return 1}async draw(t){return await Pe.call(this,t)}async update(t){this.model._num_rows=await t.num_rows(),await this.regular_table.draw()}async resize(){!this.isConnected||this.offsetParent==null||this._initialized&&await this.regular_table.draw()}async clear(){this.regular_table._resetAutoSize(),this.regular_table.clear()}save(){return Oe.call(this)}restore(t){return ze.call(this,t)}async restyle(t){await this.draw(t)}delete(){this.regular_table.table_model&&this.regular_table._resetAutoSize(),this.regular_table.clear()}};var Re=':host{position:relative;display:block;}:host #container{position:absolute;display:flex;flex-direction:column;justify-content:stretch;align-items:stretch;top:0;left:0;right:0;bottom:0;}:host #toolbar{display:flex;align-items:center;height:36px;}:host #slot-container{flex:1;position:relative;}#scroll_lock.lock-scroll:before{-webkit-mask-image:var(--toolbar-scroll-lock-active--content);}#scroll_lock:before{-webkit-mask-image:var(--toolbar-scroll-lock--content);}#select_mode:before{content:"highlight_alt";}#edit_mode:before{-webkit-mask-image:var(--toolbar-edit-mode--content);}#edit_mode.editable:before{-webkit-mask-image:var(--toolbar-edit-mode-active--content);}:host(.aggregated) #toolbar #edit_mode{display:none;}.button:before{width:25px;height:21px;content:"";-webkit-mask-image:cover;mask-image:cover;background-color:var(--icon--color,#ccc);margin:0 5px;}.button.editable:before,.button.lock-scroll:before{color:inherit;}.button{display:inline-flex;align-items:center;user-select:none;width:37px;height:22px;box-sizing:border-box;white-space:nowrap;border:1px solid transparent;border-radius:3px;}.button>span{display:none;margin:0;padding:0;}.button:hover{background-color:var(--icon--color);color:var(--plugin--background);opacity:1;display:flex;align-items:center;cursor:pointer;min-width:var(--button--min-width,105px);}.button:hover:before{background-color:var(--plugin--background);margin:0 5px 0 5px;}.button:hover>span{display:contents;font-size:9px;line-height:36px;}';var B=class extends HTMLElement{connectedCallback(){if(this._initialized)return;this._initialized=!0,this.setAttribute("slot","plugin-settings"),this.attachShadow({mode:"open"}),this.shadowRoot.innerHTML=`
            <style>
                ${Re}
            </style>
            <div id="toolbar">
                <span id="scroll_lock" class="button">
                    <span>Free Scroll</span>
                </span>
                <span id="edit_mode" class="button"><span>Read Only</span></span>
            </div>
        `;let t=this.parentElement,r=t.querySelector("perspective-viewer-datagrid");r._scroll_lock=this.shadowRoot.querySelector("#scroll_lock"),r._scroll_lock.addEventListener("click",()=>H.call(r)),r._edit_mode=this.shadowRoot.querySelector("#edit_mode"),r._edit_mode.addEventListener("click",()=>{F.call(r),r.regular_table.draw(),t.dispatchEvent(new Event("perspective-config-update"))})}};function Ue(){let e=document.createElement("style");e.textContent=X,document.head.insertBefore(e,document.head.firstChild)}async function Ge(){customElements.define("perspective-viewer-datagrid-toolbar",B),customElements.define("perspective-viewer-datagrid",j),await customElements.whenDefined("perspective-viewer"),customElements.get("perspective-viewer").registerPlugin("perspective-viewer-datagrid")}Ge();Ue();
//# sourceMappingURL=perspective-viewer-datagrid.js.map
