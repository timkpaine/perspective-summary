{
  "version": 3,
  "sources": ["../../src/ts/migrate.ts"],
  "sourcesContent": ["/******************************************************************************\n *\n * Copyright (c) 2017, the Perspective Authors.\n *\n * This file is part of the Perspective library, distributed under the terms of\n * the Apache License 2.0.  The full license can be found in the LICENSE file.\n *\n */\n\n/**\n * A migration utility for `@finos/perspective-viewer` and\n * `@finos/perspective-workspace` persisted state objects.  If you have an\n * application which persists tokens returned by the `.save()` method of a\n * Perspective Custom Element, and you want to upgrade Perspective to the latest\n * version, this module is for you!  You know who you are!\n *\n * Say you have a `<perspective-viewer>` Custom Element from\n * `@finos/perspective-viewer>=0.8.3`, and have persisted an arbitrary persistence\n * token object:\n *\n * ```javascript\n * const old_elem = document.querySelector(\"perspective-viewer\");\n * const old_token = await old_elem.save();\n * ```\n *\n * To migrate this token to the version of `@finos/perspective-migrate` itself:\n *\n * ```javascript\n * import {convert} from \"@finos/perspective-viewer`;\n *\n * // ...\n *\n * const new_elem = document.querySelector(\"perspective-viewer\");\n * const new_token = convert(old_token);\n * await new_elem.restore(new_token);\n * ```\n *\n * `convert` can also be imported in node for converting persisted tokens\n * outside the browser.\n *\n * ```javascript\n * const {convert} = require(\"@finos/perspective-viewer/dist/cjs/migrate.js\");\n * ```\n * @param old the layout to convert, in `<perspective-viewer>` or\n * `<perspective-workspace>` format.\n * @param options a `PerspectiveConvertOptions` object specifying the convert\n * options for this call.\n * @returns a layout for either `<perspective-viewer>` or\n * `<perspective-workspace>`, updated to the perspective version of this\n * script's package.\n */\nexport function convert(\n    old: Record<string, unknown> | ArrayBuffer | string,\n    { warn = true, replace_defaults = false }: PerspectiveConvertOptions = {}\n): Record<string, unknown> | ArrayBuffer | string {\n    if (typeof old === \"object\" && !(old instanceof ArrayBuffer)) {\n        const copy = JSON.parse(JSON.stringify(old));\n        if (\"viewers\" in copy && \"detail\" in copy) {\n            return migrate_workspace(copy, { warn, replace_defaults });\n        } else {\n            return migrate_viewer(copy, false, { warn, replace_defaults });\n        }\n    } else {\n        return old;\n    }\n}\n\ntype PerspectiveConvertOptions = {\n    warn?: boolean;\n    replace_defaults?: boolean;\n};\n\n/**\n * Migrate a layout for `<perspective-workspace>`\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_workspace(old, options) {\n    for (const key in old.viewers) {\n        old.viewers[key] = migrate_viewer(old.viewers[key], true, options);\n        if (!(\"master\" in old.viewers[key])) {\n            old.viewers[key].master = false;\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective missing attribute \"master\" set to default`\n                );\n            }\n        }\n\n        if (!(\"linked\" in old.viewers[key])) {\n            old.viewers[key].linked = false;\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective missing attribute \"linked\" set to default`\n                );\n            }\n        }\n    }\n\n    return old;\n}\n\n/**\n * Migrate a layout for `<perspective-viewer>`\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_viewer(old, omit_attributes, options) {\n    return chain(\n        old,\n        [\n            migrate_group_by,\n            migrate_split_by,\n            migrate_filters,\n            migrate_expressions,\n            options.replace_defaults ? migrate_nulls : false,\n            migrate_plugins,\n            migrate_plugin_config,\n            migrate_title,\n            migrate_name_title_workspace,\n            omit_attributes\n                ? migrate_attributes_workspace\n                : migrate_attributes_viewer,\n        ].filter((x) => !!x),\n        options\n    );\n}\n\n/**\n * Chains functions of `args` and apply to `old`\n * @param old\n * @param args\n * @param options\n * @returns\n */\nfunction chain(old, args, options) {\n    for (const arg of args) {\n        old = arg(old, options);\n    }\n\n    return old;\n}\n\n/**\n * Replace `null` properties with defaults.  This is not strictly behavioral,\n * as new `<perspective-viewer>` treats `null` as an explicit \"reset to default\"\n * instruction.  However, it may be necessary to ensure that `.save()` returns\n * identical results to `convert()`, which may be desirable when migrating a\n * database of layouts.\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_nulls(old, options) {\n    for (const key of [\"group_by\", \"split_by\", \"filter\", \"sort\"]) {\n        if (old[key] === null) {\n            old[key] = [];\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective missing attribute \"${key}\" set to default\"`\n                );\n            }\n        }\n\n        if (\"aggregates\" in old && old.aggregates === null) {\n            old.aggregates = {};\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective missing attribute \"aggregates\" set to default\"`\n                );\n            }\n        }\n    }\n\n    return old;\n}\n\n/**\n * Helper for alias-replacement migrations\n * @param original\n * @param aliases\n * @returns\n */\nfunction _migrate_field_aliases(original, aliases) {\n    return function (old, options) {\n        let count = 0;\n        for (const pivot of aliases) {\n            if (pivot in old) {\n                if (count++ > 0) {\n                    throw new Error(`Duplicate \"${original}\" fields`);\n                }\n\n                old[original] = old[pivot];\n                if (pivot !== original) {\n                    delete old[pivot];\n                    if (options.warn) {\n                        console.warn(\n                            `Deprecated perspective attribute \"${pivot}\" renamed \"${original}\"`\n                        );\n                    }\n                }\n            }\n        }\n\n        return old;\n    };\n}\n\n/**\n * Migrate `group_by` field aliases\n */\nconst migrate_group_by = _migrate_field_aliases(\"group_by\", [\n    \"group_by\",\n    \"row_pivots\",\n    \"row-pivot\",\n    \"row-pivots\",\n    \"row_pivot\",\n]);\n\n/**\n * Migrate `split_by` field aliases\n */\nconst migrate_split_by = _migrate_field_aliases(\"split_by\", [\n    \"split_by\",\n    \"column_pivots\",\n    \"column-pivot\",\n    \"column-pivots\",\n    \"column_pivot\",\n    \"col_pivots\",\n    \"col-pivot\",\n    \"col-pivots\",\n    \"col_pivot\",\n]);\n\n/**\n * Migrate `filters` field aliases\n */\nconst migrate_filters = _migrate_field_aliases(\"filter\", [\"filter\", \"filters\"]);\n\n/**\n * Migrate the old `computed-columns` format expressions to ExprTK\n * @param regex1\n * @param rep\n * @param expression\n * @param old\n * @param options\n * @returns\n */\nfunction _migrate_expression(regex1, rep, expression, old, options) {\n    if (regex1.test(expression)) {\n        const replaced = expression.replace(regex1, rep);\n        if (options.warn) {\n            console.warn(\n                `Deprecated perspective \"expression\" attribute value \"${expression}\" updated to \"${replaced}\"`\n            );\n        }\n\n        for (const key of [\"group_by\", \"split_by\"]) {\n            if (key in old) {\n                for (const idx in old[key]) {\n                    const pivot = old[key][idx];\n                    if (pivot === expression.replace(/\"/g, \"\")) {\n                        old[key][idx] = replaced;\n                        if (options.warn) {\n                            console.warn(\n                                `Deprecated perspective expression in \"${key}\" attribute \"${expression}\" replaced with \"${replaced}\"`\n                            );\n                        }\n                    }\n                }\n            }\n        }\n\n        for (const filter of old.filter || []) {\n            if (filter[0] === expression.replace(/\"/g, \"\")) {\n                filter[0] = replaced;\n                if (options.warn) {\n                    console.warn(\n                        `Deprecated perspective expression in \"filter\" attribute \"${expression}\" replaced with \"${replaced}\"`\n                    );\n                }\n            }\n        }\n\n        for (const sort of old.sort || []) {\n            if (sort[0] === expression.replace(/\"/g, \"\")) {\n                sort[0] = replaced;\n                if (options.warn) {\n                    console.warn(\n                        `Deprecated perspective expression in \"sort\" attribute \"${expression}\" replaced with \"${replaced}\"`\n                    );\n                }\n            }\n        }\n\n        return replaced;\n    } else {\n        return expression;\n    }\n}\n\nfunction migrate_title(old) {\n    if (old[\"title\"] === undefined) {\n        old.title = null;\n    }\n\n    return old;\n}\n\n/**\n * Migrate `expressions` field from `computed-columns`\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_expressions(old, options) {\n    if (old[\"computed-columns\"]) {\n        if (\"expressions\" in old) {\n            throw new Error(`Duplicate \"expressions\" and \"computed-columns`);\n        }\n\n        old.expressions = old[\"computed-columns\"];\n        delete old[\"computed-columns\"];\n        if (options.warn) {\n            console.warn(\n                `Deprecated perspective attribute \"computed-columns\" renamed \"expressions\"`\n            );\n        }\n\n        const REPLACEMENTS = [\n            [/^year_bucket\\(\"(.+?)\"\\)/, `bucket(\"$1\", 'y')`],\n            [/^month_bucket\\(\"(.+?)\"\\)/, `bucket(\"$1\", 'M')`],\n            [/^day_bucket\\(\"(.+?)\"\\)/, `bucket(\"$1\", 'd')`],\n            [/^hour_bucket\\(\"(.+?)\"\\)/, `bucket(\"$1\", 'h')`],\n            [/^minute_bucket\\(\"(.+?)\"\\)/, `bucket(\"$1\", 'm')`],\n            [/^second_bucket\\(\"(.+?)\"\\)/, `bucket(\"$1\", 's')`],\n        ];\n\n        for (const idx in old.expressions) {\n            let expression = old.expressions[idx];\n            for (const [a, b] of REPLACEMENTS) {\n                expression = _migrate_expression(\n                    a,\n                    b,\n                    expression,\n                    old,\n                    options\n                );\n            }\n\n            old.expressions[idx] = expression;\n        }\n    }\n\n    return old;\n}\n\n/**\n * Migrate the `plugin` field\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_plugins(old, options) {\n    const ALIASES = {\n        datagrid: \"Datagrid\",\n        Datagrid: \"Datagrid\",\n        d3_y_area: \"Y Area\",\n        \"Y Area\": \"Y Area\",\n        d3_y_line: \"Y Line\",\n        \"Y Line\": \"Y Line\",\n        d3_xy_line: \"X/Y Line\",\n        \"X/Y Line\": \"X/Y Line\",\n        d3_y_scatter: \"Y Scatter\",\n        \"Y Scatter\": \"Y Scatter\",\n        d3_xy_scatter: \"X/Y Scatter\",\n        \"X/Y Scatter\": \"X/Y Scatter\",\n        d3_x_bar: \"X Bar\",\n        \"X Bar\": \"X Bar\",\n        d3_y_bar: \"Y Bar\",\n        \"Y Bar\": \"Y Bar\",\n        d3_heatmap: \"Heatmap\",\n        Heatmap: \"Heatmap\",\n        d3_treemap: \"Treemap\",\n        Treemap: \"Treemap\",\n        d3_sunburst: \"Sunburst\",\n        Sunburst: \"Sunburst\",\n    };\n\n    if (\"plugin\" in old && old.plugin !== ALIASES[old.plugin]) {\n        old.plugin = ALIASES[old.plugin];\n        if (options.warn) {\n            console.warn(\n                `Deprecated perspective \"plugin\" attribute value \"${\n                    old.plugin\n                }\" updated to \"${ALIASES[old.plugin]}\"`\n            );\n        }\n    }\n\n    return old;\n}\n\n/**\n * Migrate the `plugin_config` field\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_plugin_config(old, options) {\n    if (old.plugin === \"Datagrid\" && !!old.plugin_config) {\n        if (!old.plugin_config.columns) {\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective attribute \"plugin_config\" moved to \"plugin_config.columns\"`\n                );\n            }\n\n            const columns = {};\n            for (const name of Object.keys(old.plugin_config)) {\n                const column = old.plugin_config[name];\n                delete old.plugin_config[name];\n\n                if (typeof column.color_mode === \"string\") {\n                    if (column.color_mode === \"foreground\") {\n                        column.number_fg_mode = \"color\";\n                    } else if (column.color_mode === \"bar\") {\n                        column.number_fg_mode = \"bar\";\n                    } else if (column.color_mode === \"background\") {\n                        column.number_bg_mode = \"color\";\n                    } else if (column.color_mode === \"gradient\") {\n                        column.number_bg_mode = \"gradient\";\n                    } else {\n                        console.warn(`Unknown color_mode ${column.color_mode}`);\n                    }\n\n                    // column.number_color_mode = column.color_mode;\n                    delete column[\"color_mode\"];\n\n                    if (options.warn) {\n                        console.warn(\n                            `Deprecated perspective attribute \"color_mode\" renamed \"number_bg_mode\"`\n                        );\n                    }\n                }\n\n                columns[name] = column;\n            }\n\n            old.plugin_config.columns = columns;\n            if (options.replace_defaults) {\n                old.plugin_config.editable = false;\n                old.plugin_config.scroll_lock = true;\n            }\n        }\n\n        // Post 1.5, number columns have been split between `fg` and `bg`\n        // style param contexts.\n        for (const name of Object.keys(old.plugin_config.columns)) {\n            const column = old.plugin_config.columns[name];\n\n            if (typeof column.number_color_mode === \"string\") {\n                if (column.number_color_mode === \"foreground\") {\n                    column.number_fg_mode = \"color\";\n                } else if (column.number_color_mode === \"bar\") {\n                    column.number_fg_mode = \"bar\";\n                } else if (column.number_color_mode === \"background\") {\n                    column.number_bg_mode = \"color\";\n                } else if (column.number_color_mode === \"gradient\") {\n                    column.number_bg_mode = \"gradient\";\n                }\n\n                delete column[\"number_color_mode\"];\n\n                if (options.warn) {\n                    console.warn(\n                        `Deprecated perspective attribute \"number_color_mode\" renamed \"number_bg_mode\"`\n                    );\n                }\n            }\n\n            if (column.gradient !== undefined) {\n                if (column.number_bg_mode === \"gradient\") {\n                    column.bg_gradient = column.gradient;\n                } else if (column.number_fg_mode === \"bar\") {\n                    column.fg_gradient = column.gradient;\n                }\n\n                delete column[\"gradient\"];\n                if (options.warn) {\n                    console.warn(\n                        `Deprecated perspective attribute \"gradient\" renamed \"bg_gradient\"`\n                    );\n                }\n            }\n\n            if (column.pos_color !== undefined) {\n                if (column.number_bg_mode !== undefined) {\n                    column.pos_bg_color = column.pos_color;\n                } else if (column.number_fg_mode !== undefined) {\n                    column.pos_fg_color = column.pos_color;\n                }\n\n                delete column[\"pos_color\"];\n                if (options.warn) {\n                    console.warn(\n                        `Deprecated perspective attribute \"pos_color\" renamed \"pos_bg_color\"`\n                    );\n                }\n            }\n\n            if (column.neg_color !== undefined) {\n                if (column.number_bg_mode !== undefined) {\n                    column.neg_bg_color = column.neg_color;\n                } else if (column.number_fg_mode !== undefined) {\n                    column.neg_fg_color = column.neg_color;\n                }\n\n                delete column[\"neg_color\"];\n                if (options.warn) {\n                    console.warn(\n                        `Deprecated perspective attribute \"neg_color\" renamed \"neg_bg_color\"`\n                    );\n                }\n            }\n        }\n    }\n\n    return old;\n}\n\n/**\n * Migrate attributes which were once persisted but are now considered errors\n * in `<perspective-viewer>` and should only be set in HTML\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_attributes_viewer(old, options) {\n    const ATTRIBUTES = [\n        \"editable\",\n        \"selectable\",\n        \"name\",\n        \"table\",\n        \"master\",\n        \"linked\",\n    ];\n    for (const attr of ATTRIBUTES) {\n        if (attr in old) {\n            delete old[attr];\n\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective attribute \"${attr}\" removed`\n                );\n            }\n        }\n    }\n\n    return old;\n}\n\n/**\n * Migrate attributes which were once persisted but are now considered errors\n * in `<perspective-workspace>` and should only be set in HTML\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_attributes_workspace(old, options) {\n    const ATTRIBUTES = [\n        \"editable\",\n        \"selectable\",\n        \"name\",\n        \"table\",\n        \"master\",\n        \"linked\",\n    ];\n    for (const attr of ATTRIBUTES) {\n        if (attr in old && old[attr] === null) {\n            delete old[attr];\n\n            if (options.warn) {\n                console.warn(\n                    `Deprecated perspective attribute \"${attr}\" removed`\n                );\n            }\n        }\n    }\n\n    return old;\n}\n\n/**\n * Migrate workspace viewer 'name' which was unified with `title`.\n * @param old\n * @param options\n * @returns\n */\nfunction migrate_name_title_workspace(old, options) {\n    if (\"name\" in old) {\n        if (\"title\" in old && old.title !== undefined) {\n            old.title = old[\"name\"];\n            if (options.warn) {\n                console.warn(`\"name\" conflicts with \"title\"`);\n            }\n        }\n\n        delete old[\"name\"];\n\n        if (options.warn) {\n            console.warn(`\"name\" unified with \"title\"`);\n        }\n    }\n\n    return old;\n}\n"],
  "mappings": "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",
  "names": ["migrate_exports", "__export", "convert", "__toCommonJS", "old", "warn", "replace_defaults", "copy", "migrate_workspace", "migrate_viewer", "options", "key", "omit_attributes", "chain", "migrate_group_by", "migrate_split_by", "migrate_filters", "migrate_expressions", "migrate_nulls", "migrate_plugins", "migrate_plugin_config", "migrate_title", "migrate_name_title_workspace", "migrate_attributes_workspace", "migrate_attributes_viewer", "x", "args", "arg", "_migrate_field_aliases", "original", "aliases", "count", "pivot", "_migrate_expression", "regex1", "rep", "expression", "replaced", "idx", "filter", "sort", "REPLACEMENTS", "a", "b", "ALIASES", "columns", "name", "column", "ATTRIBUTES", "attr"]
}
